## Kubernetes en AWS

Hace un año atrás deployar un cluster de Kubernetes en Amazon desde cero no era tarea fácil, tenias que hacerlo a mano, crear tu propia herramienta o usar alguna solución ya existente que no estaba ni completa ni muy bien documentada. Kubernetes era algo reservado solo a unos pocos expertos o apasionados de las nuevas tecnologías que se aventuraban a probar algo no del todo 'terminado'. Si lo que querías era un cluster en HA, resistente a fallos, con auto escalado, en tu hosting habitual y con el nivel de seguridad/fiabilidad de un entorno de producción la cosa se volvía imposible. Mucha gente, entre los cuales me incluyo, desistía al ver la faena que se le venía encima sin ver las ventajas que consigo traía. No había posibilidad de tener multi-zona en Amazon, aún menos multi-master y otras tantas cosas que hacían que uno no se animara a probar.

Por esas fechas empecé a trabajar en un proyecto basado en contenedores y revisé algunas de las herramientas existentes que desplegaban Kubernetes en Amazon, al no convencerme ninguna de ellas me aventuré a desplegar los servicios usando Amazon ECS(la solución de Amazon para contenedores). Sinceramente ECS tampoco estaba muy avanzado en esos tiempos pero me permitió olvidarme de masters y poder tener algo corriendo en multi zona. No tardé mucho en descubrir que ECS tampoco era la panacea, tenía otros muchos problemas que iban saliendo a medida que lo usabas y crecía la complejidad del despliegue o sus necesidades... seguía con esa sensación de decepción ¿Cómo podía ser posible que nadie hubiera creado alguna herramienta para facilitar un despliegue decente de Kubernetes en Amazon?

Pasado un tiempo de mi primer intento y sintiéndome decepcionado por ECS volví a revisar las herramientas que anteriormente había visto, me centré en 2 de ellas, Kops y kube-aws. Kops desplegaba un cluster de Kubernetes en Amazon usando Terraform (infrastructure as code de Hashicorp) y kube-aws hacía más o menos lo mismo pero usando Cloudformation(infrastructure as code de Amazon). Las dos tenían aún mucho camino por recorrer, no disponían de multi máster, tampoco tenían un deploy decente de ETCD(parte esencial de Kubernetes) y otros tantos problemas pero ya pintaban un poco mejor que hacía unos meses. Después de probarlas a fondo y valorar que me convencía más de cada una me decanté por kube-aws. Un servidor ya tenia Cloudformation por la mano y la infraestructura de mi empresa también lo usaba con lo que lo más lógico era usar esa solución. En aquel momento kube-aws ya permitía desplegar nodos en multi-zona, aún le faltaba multi-master y muchas cosas pero la velocidad a la que se le añadían features y el roadmap de futuras versiones me hicieron ver que, si bien algunas de mis necesidades no estaban cubiertas en ese momento, lo estarían en poco tiempo. También contaba con la ventaja de que al basarse en Cloudformation una vez realizado el template podía modificar el fichero para ajustar, añadir o quitar lo que me interesara.


